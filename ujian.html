<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Ujian</title>

<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="libs/bootstrap-icons.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">



<style>
    .benar { color: green; font-weight: bold; }
    .salah { color: red; font-weight: bold; }
    .kotak-review {
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 6px;
        margin-bottom: 12px;
        background: #f9f9f9;
    }

    /* =============================
       RESPONSIVE MOBILE PASTI JALAN
       ============================= */
    @media (max-width: 600px) {

        body {
            margin: 0;
            padding: 0;
            background: #f1f1f1;
        }

        .container, #app {
            width: 100% !important;
            max-width: 100% !important;
            padding: 10px !important;
            margin: 0 !important;
        }

        #soalBox, .kotak-review {
            width: 100% !important;
            background: #fff;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        #judulMapel {
            margin-top: 60px !important;
            font-size: 22px !important;
        }

        label {
            display: block;
            width: 100%;
            background: #fafafa;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        input[type="radio"] {
            transform: scale(1.3);
            margin-right: 8px;
        }

        #nextBtn {
            width: 100% !important;
            padding: 14px !important;
            font-size: 17px;
            border-radius: 8px;
        }
    }
</style>


</head>

<body>
  
  <marquee behavior="scroll" direction="left">
  Ayo belajar biar gak bodo kek JungMok, Hidup Jkw!!, bapak kau, gampang bamget brok
</marquee>
<div class="container" id="app">
<a href="index.html" class="btn btn-primary btn-back"
   style="position: fixed; top: 15px; left: 15px; z-index: 999;">
    <i class="bi bi-house-door-fill"></i>
</a>
    <h2 id="judulMapel"><i class="bi bi-pencil-square"></i> Ujian</h2>

    <div id="soalBox"></div>

    <button id="nextBtn" class="btn">
        Selanjutnya <i class="bi bi-arrow-right"></i>
    </button>
</div>

<footer class="footer">
    <p>by <span>A.K Eleven</span></p>
    <p class="subtext">Cuma latihan doang brok</p>
</footer>

<script>
let mapel = new URLSearchParams(window.location.search).get("mapel");

// Load soal berdasarkan mapel (soal_bi.js, soal_pai.js, dll)
let script = document.createElement("script");
script.src = "data/soal_" + mapel + ".js";
document.body.appendChild(script);

script.onload = () => mulaiUjian();

// Variabel
let soal = [];
let index = 0;
let jawabanUser = [];

// Random array
function acak(arr) {
    return arr.sort(() => Math.random() - 0.5);
}

// Mulai ujian
function mulaiUjian() {
    document.getElementById("judulMapel").innerHTML =
        `<i class="bi bi-pencil-square"></i> Ujian: ${mapel.toUpperCase()}`;

    soal = [];

    // gabungkan seluruh bab dari soalData
    for (let bab in soalData) {
        soal.push(...acak(soalData[bab]));
    }

    tampilSoal();
}

// Tampilkan soal
function tampilSoal() {
    if (index >= soal.length) return selesai();

    let s = soal[index];

    document.getElementById("soalBox").innerHTML = `
        <div><b>Soal ${index + 1} / ${soal.length}</b></div>
        <p>${s.soal}</p>

        <label><input type="radio" name="jwb" value="a"> ${s.a}</label><br>
        <label><input type="radio" name="jwb" value="b"> ${s.b}</label><br>
        <label><input type="radio" name="jwb" value="c"> ${s.c}</label><br>
        <label><input type="radio" name="jwb" value="d"> ${s.d}</label><br>
    `;
}

// Tombol Next
document.getElementById("nextBtn").onclick = () => {

    let pilih = document.querySelector("input[name=jwb]:checked");

    if (!pilih) {
        alert("Pilih jawaban dulu!");
        return;
    }

    jawabanUser.push(pilih.value);
    index++;
    tampilSoal();
};



// ===============================
//    SELESAI – TAMPILKAN REVIEW
// ===============================
function selesai() {

    let benar = 0;
    let reviewHTML = `
        <h2><i class="bi bi-clipboard-check"></i> Nilai Kamu</h2>
        <h3>${benar} / ${soal.length}</h3>
        <hr>
        <h3><i class="bi bi-journal-text"></i> Review Lengkap Jawaban</h3>
    `;

    soal.forEach((s, i) => {
        let user = jawabanUser[i];
        let correct = s.jawaban;
        let status = (user === correct);

        if (status) benar++;

        reviewHTML += `
            <div class="kotak-review">
                <b>Soal ${i+1}:</b>
                <p>${s.soal}</p>

                <p>
                    <i class="bi bi-person-check"></i> Jawaban kamu:
                    <span class="${status ? 'benar' : 'salah'}">
                        ${user.toUpperCase()} – ${s[user]}
                    </span>
                </p>

                ${
                    status
                    ? `<p class="benar"><i class="bi bi-check-circle"></i> Benar</p>`
                    :
                    `
                    <p class="salah">
                        <i class="bi bi-x-circle"></i> Salah
                    </p>

                    <p>
                        <i class="bi bi-check-lg"></i> Jawaban benar:
                        <span class="benar">
                            ${correct.toUpperCase()} – ${s[correct]}
                        </span>
                    </p>
                    `
                }
            </div>
        `;
    });

    // Tampilkan hasil
    document.getElementById("app").innerHTML = `
        <div class="container">
            <h2><i class="bi bi-bar-chart-line"></i> Hasil Ujian</h2>
            <h3 class="benar">Benar: ${benar} / ${soal.length}</h3>
            <hr>
            ${reviewHTML}
        </div>
    `;
}
</script>

</body>
</html>